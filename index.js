data = {"message":[{"driver_id":0,"driver_path":[{"lat":51.51013499123903,"lng":0.07522811785358247},{"lat":51.53001239835258,"lng":0.11239226503924954},{"lat":51.53353229742646,"lng":0.10712593906546336},{"lat":51.533812976754064,"lng":0.12355998438528332},{"lat":51.5546589563074,"lng":0.10861877177563722},{"lat":51.56161918704438,"lng":0.11860386246052751},{"lat":51.57660337149809,"lng":0.09277920083952623},{"lat":51.57032255222496,"lng":0.07364527021686113},{"lat":51.57041484855659,"lng":0.03990863019905189},{"lat":51.583692776951565,"lng":0.03940848391470908},{"lat":51.58874917467177,"lng":-0.01736282805617506},{"lat":51.59457133707271,"lng":-0.023212759838363517},{"lat":51.58181853537487,"lng":-0.035151432658937776},{"lat":51.57394911465817,"lng":-0.05734706666243816},{"lat":51.55042711175115,"lng":-0.0941155006205176},{"lat":51.5473101929661,"lng":-0.09048293046435413},{"lat":51.53852948868346,"lng":-0.07099388046301919},{"lat":51.52046621294456,"lng":-0.014659365756156117},{"lat":51.527664337275816,"lng":0.0000063042546156744095},{"lat":51.570034512162295,"lng":-0.1265666700346773},{"lat":51.578273945275626,"lng":-0.12639099281546895},{"lat":51.58304119927886,"lng":-0.12030119410378787},{"lat":51.575182641323806,"lng":-0.15964916098730797},{"lat":51.56135608381473,"lng":-0.15041477951608295},{"lat":51.54996893683338,"lng":-0.15439971835705668},{"lat":51.6212688589324,"lng":-0.09092512004451081},{"lat":51.62151536511945,"lng":-0.08968532705980553},{"lat":51.613197657821935,"lng":-0.0552276852651184},{"lat":51.62683815355567,"lng":-0.021178071110242724},{"lat":51.63174081483209,"lng":-0.01742710378028378},{"lat":51.63329906010317,"lng":-0.015033812615093567},{"lat":51.63738855828468,"lng":0.03901176622725738},{"lat":51.624558036012054,"lng":0.05680801315805456},{"lat":51.64665501521364,"lng":0.07277381718835235},{"lat":51.655496816882405,"lng":0.06814804166068483},{"lat":51.65135940334798,"lng":0.08883188841764517},{"lat":51.42759744610965,"lng":-0.2371917316374329}]},{"driver_id":1,"driver_path":[{"lat":51.35247120391234,"lng":-0.24752108284960198},{"lat":51.348749122086986,"lng":-0.2426562027357095},{"lat":51.331762489451634,"lng":-0.2592639078506006},{"lat":51.33812391699484,"lng":-0.2823860345998509},{"lat":51.34698762783519,"lng":-0.3172796481232766},{"lat":51.3728115283545,"lng":-0.32742225393785007},{"lat":51.37543041355877,"lng":-0.29028054496171535},{"lat":51.37554881280698,"lng":-0.28837447980798003},{"lat":51.36960713300891,"lng":-0.26319298506989797},{"lat":51.398679792619,"lng":-0.2809918413103599},{"lat":51.40990427791529,"lng":-0.3005558862086736},{"lat":51.416678809387754,"lng":-0.3236311764823258},{"lat":51.41114823548907,"lng":-0.3283474512931892},{"lat":51.4342086389212,"lng":-0.3283359662453509},{"lat":51.44971502838799,"lng":-0.3146087494210694},{"lat":51.468994226856886,"lng":-0.2911817824212891},{"lat":51.47208994014394,"lng":-0.2746456489069487},{"lat":51.48179750561715,"lng":-0.2812994207297618},{"lat":51.49769654731273,"lng":-0.24477941218676383},{"lat":51.48066946636906,"lng":-0.22018709606654552},{"lat":51.463198086288365,"lng":-0.2058319943082027},{"lat":51.4581103286687,"lng":-0.239897463391656},{"lat":51.45005914338985,"lng":-0.25486230778362284},{"lat":51.442700989323356,"lng":-0.27337957796097595},{"lat":51.4331717904307,"lng":-0.2855070469814232},{"lat":51.420239422764986,"lng":-0.25865805201288095},{"lat":51.3947670734871,"lng":-0.23036293213460896},{"lat":51.39174542188199,"lng":-0.19727537106388432},{"lat":51.38125123964422,"lng":-0.17557047657767544},{"lat":51.398415140440584,"lng":-0.15920764403075016},{"lat":51.419542967853694,"lng":-0.15822139877144448},{"lat":51.420321958139965,"lng":-0.19322257731089507},{"lat":51.447389169371476,"lng":-0.16502555519240636},{"lat":51.463971077817654,"lng":-0.15202813277402422},{"lat":51.46999632842084,"lng":-0.16664626102641306},{"lat":51.480596701004615,"lng":-0.1448135577722255},{"lat":51.49879703381143,"lng":-0.14785873580609504},{"lat":51.509773676772895,"lng":-0.13607931295112835},{"lat":51.50874983956556,"lng":-0.19163554918591014},{"lat":51.513470840329646,"lng":-0.20834396132806848},{"lat":51.490452757074536,"lng":-0.18572407761392212},{"lat":51.46009261282703,"lng":-0.1202278073798625},{"lat":51.47075278310734,"lng":-0.08650844943412717},{"lat":51.4809553500983,"lng":-0.05832083838150559},{"lat":51.48015864494046,"lng":-0.01790293112138619},{"lat":51.474173888998976,"lng":0.037368786317184544},{"lat":51.443003384966275,"lng":0.06134167629854992},{"lat":51.42804446629249,"lng":0.0891914797555276},{"lat":51.4336996074473,"lng":0.10293806931767319},{"lat":51.42058981279755,"lng":0.07343944948447073},{"lat":51.41517139911806,"lng":0.07553424449712626},{"lat":51.39597346207475,"lng":0.0688366503940459},{"lat":51.3852940565882,"lng":0.08535064623491889},{"lat":51.37870933690457,"lng":0.08156532669783195},{"lat":51.37813659743944,"lng":0.09098831704480931},{"lat":51.36494782954742,"lng":0.10229040256155969},{"lat":51.36202502935152,"lng":0.12058232547897257},{"lat":51.368677409105445,"lng":0.12173547923889755},{"lat":51.32966214018396,"lng":0.11102017587722574},{"lat":51.349399883339274,"lng":0.0632201428448676},{"lat":51.34343306431402,"lng":0.017900544715527544},{"lat":51.33942516480708,"lng":0.003420155128722735},{"lat":51.32845535310614,"lng":-0.021001717570889422},{"lat":51.36008456917402,"lng":-0.04196938710597753},{"lat":51.37081885563795,"lng":-0.052902038535851736},{"lat":51.37136950407351,"lng":-0.053397463850717586},{"lat":51.38070192370193,"lng":-0.03157110280251019},{"lat":51.39762565114432,"lng":-0.06880721677900659},{"lat":51.41014505172462,"lng":-0.04492247222047918},{"lat":51.41615619038729,"lng":-0.05576372367526572},{"lat":51.41150567608192,"lng":-0.11034075029532531},{"lat":51.383810619769896,"lng":-0.10769176012588239},{"lat":51.340390141266106,"lng":-0.09492280052864693},{"lat":51.32842713636467,"lng":-0.08009614532689502},{"lat":51.32759990475567,"lng":-0.1671724068226813},{"lat":51.3282879741521,"lng":-0.1959332932344618},{"lat":51.355785221247025,"lng":-0.18299700679563768},{"lat":51.35394715386951,"lng":-0.17436833899838994},{"lat":51.35675367166497,"lng":-0.1739612686119439},{"lat":51.363775187955426,"lng":-0.19968518923740103},{"lat":51.338701796992126,"lng":-0.3910327044677718},{"lat":51.35257900319637,"lng":-0.42747760233962945},{"lat":51.40182533352618,"lng":-0.426243530845189},{"lat":51.43114240624582,"lng":-0.41651851731315304},{"lat":51.42951249100792,"lng":-0.3997118727473489},{"lat":51.443926669809635,"lng":-0.37088365564185194},{"lat":51.464638681139796,"lng":-0.36926837802199247},{"lat":51.47805880456079,"lng":-0.3838455662419035},{"lat":51.47640129814,"lng":-0.38886359026910877},{"lat":51.47839705583856,"lng":-0.4097381561131872},{"lat":51.46949996353732,"lng":-0.42202737855946176},{"lat":51.45179895674964,"lng":-0.4282229482856699},{"lat":51.49122643892355,"lng":-0.36982401745682625},{"lat":51.4750031330068,"lng":-0.3436937260849367},{"lat":51.47228344079518,"lng":-0.3336927351801423},{"lat":51.51441232613689,"lng":-0.38262951289269165},{"lat":51.51069938697342,"lng":-0.4108365379079403},{"lat":51.4386406119428,"lng":-0.01117762773502512},{"lat":51.4396794305883,"lng":0.01907014656512096},{"lat":51.42759744610965,"lng":-0.2371917316374329}]},{"driver_id":2,"driver_path":[{"lat":51.48524303453963,"lng":0.07535893371332403},{"lat":51.42759744610965,"lng":-0.2371917316374329}]},{"driver_id":3,"driver_path":[{"lat":51.62763886028627,"lng":-0.04164612048374961},{"lat":51.66325835845543,"lng":-0.166883556886682},{"lat":51.66730762363232,"lng":-0.17825748706837158},{"lat":51.666650582327335,"lng":-0.1871097385944446},{"lat":51.65970954366546,"lng":-0.19451546493952893},{"lat":51.628181170113926,"lng":-0.2300333014082528},{"lat":51.61653129233924,"lng":-0.2334827762872846},{"lat":51.6190294725393,"lng":-0.2524538262686023},{"lat":51.6234404536458,"lng":-0.2838734627162701},{"lat":51.59248768974948,"lng":-0.28833293512205627},{"lat":51.58814492326247,"lng":-0.2820245576874365},{"lat":51.587261728719106,"lng":-0.28155541709821963},{"lat":51.58136690847556,"lng":-0.31807700847293946},{"lat":51.576705450020405,"lng":-0.32053640004476724},{"lat":51.56425299862205,"lng":-0.30197618001021087},{"lat":51.5618398974916,"lng":-0.3011185358009699},{"lat":51.55215941366722,"lng":-0.2957936923256477},{"lat":51.55350419699173,"lng":-0.28236947921357736},{"lat":51.55423860773069,"lng":-0.2805163628791507},{"lat":51.54082022461502,"lng":-0.3031356683205674},{"lat":51.53436167874258,"lng":-0.3256128266708269},{"lat":51.528855936943806,"lng":-0.3244773439782907},{"lat":51.542835398756054,"lng":-0.3464758938288418},{"lat":51.56031133276406,"lng":-0.33452602237406426},{"lat":51.563210153491816,"lng":-0.3486568822434307},{"lat":51.563279487126856,"lng":-0.3870668484267931},{"lat":51.56766794197541,"lng":-0.38966998969038286},{"lat":51.574032208547855,"lng":-0.39464044318569647},{"lat":51.57832454740004,"lng":-0.4228195772244766},{"lat":51.57479558436674,"lng":-0.43199365154643243},{"lat":51.56528896604206,"lng":-0.42717040985101273},{"lat":51.53579644425541,"lng":-0.42988063331940735},{"lat":51.523906061094415,"lng":-0.42727843592498965},{"lat":51.52151633621403,"lng":-0.38418030712461476},{"lat":51.520013989494664,"lng":-0.3541344619801312},{"lat":51.531717568340774,"lng":-0.2332739207328663},{"lat":51.52352395542674,"lng":-0.2258367070238685},{"lat":51.563408269309654,"lng":-0.22186902679768708},{"lat":51.57290336166423,"lng":-0.23841498504463612},{"lat":51.56418030519139,"lng":-0.18228476380074637},{"lat":51.56452879699121,"lng":-0.17920505579250395},{"lat":51.59152726998081,"lng":-0.18305125367174235},{"lat":51.61071359130302,"lng":-0.17756995879089849},{"lat":51.6167535401827,"lng":-0.1894643314990624},{"lat":51.610918089371154,"lng":-0.21096916670901195},{"lat":51.64159940124143,"lng":-0.33071691281268506},{"lat":51.62939315243136,"lng":-0.3575708564354855},{"lat":51.63113881128597,"lng":-0.3647397488368417},{"lat":51.644000301984235,"lng":-0.364328884744208},{"lat":51.42759744610965,"lng":-0.2371917316374329}]},{"driver_id":4,"driver_path":[{"lat":51.43113502083113,"lng":-0.3903613765762026},{"lat":51.53496930215225,"lng":-0.18699008211506127},{"lat":51.5239787099389,"lng":-0.12095713489969662},{"lat":51.42759744610965,"lng":-0.2371917316374329}]}],"fitness":1449.220984216912,"distance":579.4586367859522}
// mapping settings
function setPinImage(id) {
    var pinColors = [ "FFA000","009688","673AB7","4CAF50", "9E9E9E"];
    var randomColor = (Math.random() * 0xFFFFFF << 0).toString(16);
    var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + pinColors[id],
    new google.maps.Size(21, 34),
    new google.maps.Point(0,0),
    new google.maps.Point(10, 34));

    return pinImage;
}

//more mapping stufff
function setPinShadow() {
    var pinShadow = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_shadow",
    new google.maps.Size(40, 37),
    new google.maps.Point(0, 0),
    new google.maps.Point(12, 35));

    return pinShadow;
}

$( document ).ready(function() {
        // jsonData = JSON.parse(data);
        nodes = data['message'];

        var driversNodes = [];

        for(var i=0; i< nodes.length; i++) {
            driversNodes.push(nodes[i].driver_path)
        }

            var map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 8,
                        center: {lat: 51.528308, lng: -0.3817765}
                    });

            var pinColors = [ "FFA000","009688","673AB7","4CAF50", "9E9E9E"];

            for(var i=0; i< driversNodes.length; i++) {
                var temp = driversNodes[i];
                var pinImage = setPinImage(i); //set the pin colour
                var pinShadow = setPinShadow();
                var driverPath = [];

                for (var j=0; j<temp.length; j++) {
                            var myLatLng = {lat: temp[j].lat, lng: temp[j].lng};
                            var marker = new google.maps.Marker({
                                map: map,
                                position: myLatLng,
                                tag: i,
                                icon: pinImage,
                                shadow: pinShadow
                              });

                            driverPath.push(myLatLng);
                }

                var userCoordinate = new google.maps.Polyline({
                    path: driverPath,
                    strokeColor: "#"+pinColors[i],
                    strokeOpacity: 1,
                    strokeWeight: 2
                });

                userCoordinate.setMap(map);
            }
});












